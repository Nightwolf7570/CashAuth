# Tools Directory

This directory contains utility scripts for data preparation and model training with Google Cloud Vertex AI.

## Scripts

### `create_vertex_import_file.py`

Creates a CSV file for importing image data into Vertex AI for model training.

**Purpose:**
- Reads COCO JSON annotation files from Google Cloud Storage
- Maps detailed categories to simplified labels (`real` or `fake`)
- Verifies image existence in GCS
- Generates `vertex_ai_import.csv` for Vertex AI import

**Requirements:**
```bash
pip install google-cloud-storage
```

**Authentication:**
```bash
gcloud auth application-default login
```

**Usage:**
```bash
python create_vertex_import_file.py
```

**Configuration:**
- `GCS_BUCKET_NAME`: Your GCS bucket name
- `GCP_PROJECT_ID`: Your GCP project ID
- `SETS`: Data sets to process (train, valid, test)

**Output:**
- `vertex_ai_import.csv`: CSV file with format `SET,GCS_URI,LABEL`

---

### `prepare_coco_dataset.py`

Prepares COCO dataset for Gemini model fine-tuning.

**Purpose:**
- Downloads COCO 2017 annotations
- Creates JSONL file for Vertex AI fine-tuning
- Maps images to captions for training

**Requirements:**
```bash
pip install requests
```

**Usage:**
```bash
python prepare_coco_dataset.py
```

**Configuration:**
- `NUM_EXAMPLES`: Number of examples to generate (default: 5000, -1 for all)
- `OUTPUT_FILE`: Output filename (default: `coco_train_for_gemini.jsonl`)

**Output:**
- `coco_train_for_gemini.jsonl`: JSONL file with image URIs and captions

---

## Generated Files

- `vertex_ai_import.csv`: Generated by `create_vertex_import_file.py`
- `coco_train_for_gemini.jsonl`: Generated by `prepare_coco_dataset.py`

These files are gitignored as they are large and can be regenerated.

---

## Related Documentation

See [`/docs/GEMINI.md`](../docs/GEMINI.md) for more information about Vertex AI model training and the overall project context.







